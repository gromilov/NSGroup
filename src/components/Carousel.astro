---
import Icon from './UI/Icon.astro';
const items = [
  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },

  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },

  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },
  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },
  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },
  {
    title: "Автоматизация процесса продаж",
    description: "Затраты на отдел продаж сократились на 1234%",
    icon: "/images/demo-logo.svg",
    image: "/images/automation.png"
  },
];
---

<section class="container mx-auto px-4 py-10 md:py-20">
  <div class="flex flex-col items-center">
    <div class="w-full text-center mb-12">
      <h2 class="text-2xl md:text-2xl md:text-4xl mb-6 leading-tight">
        За 2 года мы провели более 38+
        внедрений CRM под ключ
      </h2>
      <p class="text-base md:text-lg opacity-60 mb-8 max-w-2xl mx-auto">
        Наши решения помогают бизнесу автоматизировать процессы, увеличивать продажи и сокращать издержки.
      </p>
    </div>

    <!-- Карусель Swiper -->
    <div class="swiper-container">
      <div class="swiper-wrapper">
        {items.map((item, index) => (
          <div class="swiper-slide px-4">
            <div class="bg-[#173550]/90 backdrop-blur-sm rounded-3xl h-full border border-teal-400/10 relative overflow-hidden">
              <img 
                src={item.image} 
                alt={item.title} 
                class="w-full h-[200px] object-cover rounded-t-2xl"
                loading="lazy"
              />
              
              <div class="p-6">
                <img 
                src={item.icon} 
                alt={item.title} 
                class=""
                loading="lazy"
              />
                <h3 class="text-white text-base md:text-lg font-medium mb-2">{item.title}</h3>
                <p class="text-white/80 text-sm mb-4">{item.description}</p>
                
                {/* <div class="w-full h-1 bg-white/10 rounded-full mt-8">
                  <div class="progress-bar h-full rounded-full bg-gradient-to-r from-[#2FC6F5] to-[#2FF5E3]"></div>
                </div> */}
              </div>
            </div>
          </div>
        ))}
      </div>
      
      <!-- Навигационные кнопки -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
      
      <!-- Пагинация -->
      <div class="swiper-pagination !-bottom-10"></div>
    </div>
  </div>
</section>

<!-- Подключаем Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />

<style>
  .swiper-container {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  /* Кастомные стили */
  .progress-bar {
    width: 0;
    transition: width 5000ms linear;
  }
  
  .swiper-slide-active .progress-bar {
    width: 100%;
  }
  
  .swiper-button-next,
  .swiper-button-prev {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 50%;
    width: 48px;
    height: 48px;
    transition: all 0.3s ease;
  }
  
  .swiper-button-next:hover,
  .swiper-button-prev:hover {
    background: rgba(255, 255, 255, 0.2);
  }
  
  .swiper-button-next::after,
  .swiper-button-prev::after {
    content: '';
    display: block;
    width: 24px;
    height: 24px;
    background-size: contain;
    background-repeat: no-repeat;
  }
  
  .swiper-button-prev::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 19l-7-7 7-7' /%3E%3C/svg%3E");
  }
  
  .swiper-button-next::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 5l7 7-7 7' /%3E%3C/svg%3E");
  }
  
  .swiper-pagination-bullet {
    width: 48px;
    height: 2px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 1px;
    transition: all 0.3s ease;
    opacity: 1;
  }
  
  .swiper-pagination-bullet-active {
    background: #2FD5F5;
    width: 96px;
  }
</style>

<!-- Подключаем Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

<script is:inline>
document.addEventListener('DOMContentLoaded', () => {
  const swiper = new Swiper('.swiper-container', {
    // loop: true,
    spaceBetween: 0,
    slidesPerView: 1,
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    // pagination: {
    //   el: '.swiper-pagination',
    //   clickable: true,
    //   renderBullet: (index, className) => {
    //     return `<span class="${className}" style="width: 48px; height: 2px; background: rgba(255, 255, 255, 0.2); border-radius: 1px; transition: all 0.3s ease;"></span>`;
    //   },
    // },
    autoplay: {
      delay: 5000,
      disableOnInteraction: false,
    },
    breakpoints: {
      768: {
        slidesPerView: 1
      },
      1024: {
        slidesPerView: 3
      },
      1280: {
        slidesPerView: 4
      }
    },
    on: {
      init: function() {
        // Инициализация прогресс-бара для первого слайда
        // const activeSlide = this.slides[this.activeIndex];
        // const progressBar = activeSlide.querySelector('.progress-bar');
        // if (progressBar) progressBar.style.width = '100%';
      },
      slideChange: function() {
        // Сброс всех прогресс-баров
        // document.querySelectorAll('.progress-bar').forEach(bar => {
        //   bar.style.width = '0';
        // });
        
        // // Активация прогресс-бара для текущего слайда
        // const activeSlide = this.slides[this.activeIndex];
        // const progressBar = activeSlide.querySelector('.progress-bar');
        // if (progressBar) progressBar.style.width = '100%';
      }
    }
  });
});
</script>